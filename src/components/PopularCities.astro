---
import '../styles/components/popular-cities-simple.css';
import type { I18nPageHelper } from '../utils/i18n-page';

export interface Props {
  title?: string;
  limit?: number;
  i18n?: I18nPageHelper;
}

const {
  title = "Top Northern Lights Locations in the UK",
  limit = 12,
  i18n
} = Astro.props;

// Popular UK aurora viewing locations (slugs verified from cities.json)
const popularCities = [
  { name: 'Lerwick', slug: 'lerwick', country: 'United Kingdom', flag: 'ðŸ‡¬ðŸ‡§' },
  { name: 'Kirkwall', slug: 'kirkwall', country: 'United Kingdom', flag: 'ðŸ‡¬ðŸ‡§' },
  { name: 'Thurso', slug: 'thurso', country: 'United Kingdom', flag: 'ðŸ‡¬ðŸ‡§' },
  { name: 'Inverness', slug: 'inverness', country: 'United Kingdom', flag: 'ðŸ‡¬ðŸ‡§' },
  { name: 'Fort William', slug: 'fort-william', country: 'United Kingdom', flag: 'ðŸ‡¬ðŸ‡§' },
  { name: 'Aberdeen', slug: 'aberdeen', country: 'United Kingdom', flag: 'ðŸ‡¬ðŸ‡§' },
  { name: 'Edinburgh', slug: 'edinburgh', country: 'United Kingdom', flag: 'ðŸ‡¬ðŸ‡§' },
  { name: 'Glasgow', slug: 'glasgow', country: 'United Kingdom', flag: 'ðŸ‡¬ðŸ‡§' },
  { name: 'Newcastle', slug: 'newcastle', country: 'United Kingdom', flag: 'ðŸ‡¬ðŸ‡§' },
  { name: 'Belfast', slug: 'belfast', country: 'United Kingdom', flag: 'ðŸ‡¬ðŸ‡§' },
  { name: 'Manchester', slug: 'manchester', country: 'United Kingdom', flag: 'ðŸ‡¬ðŸ‡§' },
  { name: 'London', slug: 'london', country: 'United Kingdom', flag: 'ðŸ‡¬ðŸ‡§' }
];

const displayCities = popularCities.slice(0, limit);

// Build language-aware href
const buildCityHref = (citySlug: string) => {
  if (i18n && i18n.lang !== 'en') {
    return `/${i18n.lang}/${citySlug}`;
  }
  return `/${citySlug}`;
};

const homeHref = i18n && i18n.lang !== 'en' ? `/${i18n.lang}` : '/';
---

<aside class="popular-cities">
  <h2 class="popular-cities__title">{title}</h2>
  <div class="popular-cities__grid">
    {displayCities.map((city) => (
      <a href={buildCityHref(city.slug)} class="city-link">
        <span class="city-link__flag">{city.flag}</span>
        <span class="city-link__name">{city.name}</span>
        <span class="city-link__country">{city.country}</span>
      </a>
    ))}
  </div>
  <div class="popular-cities__footer">
    <a href={homeHref} class="regions-link">
      Browse all regions â†’
    </a>
  </div>
</aside>
